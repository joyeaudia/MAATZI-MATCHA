// @ts-nocheck
!function(){"use strict";function e(){return function(e){try{return JSON.parse(localStorage.getItem(e)||"[]")}catch(e){return[]}}("orders")}function t(e){return"Rp "+new Intl.NumberFormat("id-ID").format(Number(e||0))}function n(e){return String(e||"").replace(/[&<>"']/g,(e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[e])))}function i(e,t,n){const i=document.getElementById(e);i&&(i.textContent=t||"",i.classList.remove("done","upcoming","not"),n&&("done"===n?i.classList.add("done"):"upcoming"===n?i.classList.add("upcoming"):i.classList.add("not")))}function d(t){const n=document.getElementById("detail-cancel-btn");if(!n)return;const i=(t.paymentStatus||"pending").toLowerCase(),d=(t.status||"").toLowerCase();"paid"===i||("rejected"===i||"cancelled"===d)||"delivered"===d?n.style.display="none":n.addEventListener("click",(function(){if(!confirm("Yakin ingin membatalkan order ini?"))return;const n=e()||[],i=n.findIndex((e=>String(e.id)===String(t.id)));var d;-1!==i&&(n[i].status="cancelled",n[i].paymentStatus="rejected",d=n,localStorage.setItem("orders",JSON.stringify(d||[]))),alert("Order telah dibatalkan. Status: cancelled"),window.location.href="order.html"}))}document.addEventListener("DOMContentLoaded",(function(){const a=new URLSearchParams(window.location.search).get("id"),o=(e()||[]).find((e=>String(e.id)===String(a)));if(!o)return alert("Order tidak ditemukan."),void(window.location.href="order.html");!function(e){const t=document.getElementById("detail-status-pill"),n=document.getElementById("detail-order-id"),i=document.getElementById("detail-order-date"),d=document.getElementById("detail-scheduled"),a=document.getElementById("detail-payment-method");if(n&&(n.textContent=e.id||"-"),i){const t=e.createdAt?new Date(e.createdAt):new Date;i.textContent=t.toLocaleString()}if(d)if(e.scheduledDelivery)try{const t=new Date(e.scheduledDelivery);d.textContent=isNaN(t.getTime())?e.scheduledDelivery:t.toLocaleDateString()}catch(t){d.textContent=e.scheduledDelivery}else if(e.scheduledAt){const t=new Date(e.scheduledAt);d.textContent=t.toLocaleString()}else d.textContent="-";if(a&&(a.textContent=e.paymentMethod||"QRIS"),t){const n=(e.status||"active").toLowerCase();let i="Active";"scheduled"===n?i="Scheduled":"delivered"===n?i="Delivered":"cancelled"===n&&(i="Cancelled"),t.textContent=i,t.classList.remove("shipped"),t.style.background="delivered"===n?"#10b981":"cancelled"===n?"#ef4444":"#0B84FF"}}(o),function(e){const i=document.getElementById("detail-items");i&&(i.innerHTML="",(e.items||[]).forEach((e=>{const d=document.createElement("div");d.className="product";const a=e.image?`\n          <div class="thumb">\n            <img src="${n(e.image)}"\n                 alt="${n(e.title||"")}"\n                 style="width:100%;height:100%;object-fit:cover;border-radius:16px;">\n          </div>\n        `:'<div class="thumb"></div>';d.innerHTML=`\n        ${a}\n        <div class="pinfo">\n          <div class="pname" style="font-size:13px;line-height:1.3;">\n            ${n(e.title||"")}\n          </div>\n          <div class="psub" style="font-size:11px;color:#888;">\n            ${n(e.brand||"")}\n          </div>\n          <div class="price" style="font-size:13px;margin-top:4px;">\n            ${t(e.unitPrice||e.subtotal||0)}\n          </div>\n        </div>\n        <div class="qty">${e.qty||1}</div>\n      `,i.appendChild(d)})))}(o),function(e){const n=document.getElementById("detail-summary");if(!n)return;const i=(e.items||[]).reduce(((e,t)=>{const n=Number(t.qty||1),i=null!=t.unitPrice?Number(t.unitPrice):Number(t.subtotal||0);if(!isNaN(n)&&!isNaN(i)){const d=null!=t.subtotal?Number(t.subtotal):n*i;return e+(isNaN(d)?0:d)}return e}),0),d=isNaN(Number(e.shippingFee))?0:Number(e.shippingFee),a=i+d;n.innerHTML=`\n      <div class="summary-row">\n        <div class="left">Product Subtotal</div>\n        <div class="right">${t(i)}</div>\n      </div>\n      <div class="summary-row">\n        <div class="left">Shipping Fee</div>\n        <div class="right">${t(d)}</div>\n      </div>\n      <div class="summary-row total">\n        <div class="left">Order Total</div>\n        <div class="right">${t(a)}</div>\n      </div>\n    `}(o),function(e){const t=e.tracking||{},n=(e.status||"").toLowerCase(),d=(e.paymentStatus||"").toLowerCase(),a=null==t.placed||!!t.placed,o=null!=t.paymentConfirmed?!!t.paymentConfirmed:"paid"===d,r=!!t.waitingForSchedule,c=!!t.preparingOrder,l=t.outForDelivery||{},s=!!l.active,u=l.info||"",m=!!t.delivered||"delivered"===n;i("track-placed",a?"Completed":"",a?"done":""),o?i("track-payment","Completed","done"):i("track-payment","Pending","not"),i("track-wait",r?"Completed":"",r?"done":""),i("track-prep",c?"Completed":"",c?"done":"");let v="",p="";(s||u)&&(v=u||"On the way",p="done"),i("track-out",v,p),i("track-delivered",m?"Completed":"",m?"done":"")}(o),d(o)}))}();