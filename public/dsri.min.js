// @ts-nocheck
!async function(){"use strict";const e=e=>document.querySelector(e),t=e=>"Rp "+new Intl.NumberFormat("id-ID").format(Number(e)||0);function r(e,t={}){const r=document.createElement(e);return Object.entries(t).forEach((([e,t])=>{"text"===e?r.textContent=t:"html"===e?r.innerHTML=t:"class"===e?r.className=t:r.setAttribute(e,String(t))})),r}function n(e=[]){const t=document.getElementById("product-options");t&&(t.innerHTML="",Array.isArray(e)&&0!==e.length?(t.style.display="",e.forEach((e=>{const n=r("fieldset",{class:"opt-group"}),i=r("legend",{text:e.title||""});n.appendChild(i),e.note&&n.appendChild(r("p",{class:"opt-note",text:e.note}));const a=e.key||"opt_"+Math.random().toString(36).slice(2,7);if("select"===e.type){const i=r("select",{name:a});return i.addEventListener("change",(()=>o())),e.choices.forEach((e=>{const t=r("option",{value:e.id,text:e.label||e.id});t.dataset.price=e.price||0,!1===e.enabled&&(t.disabled=!0),e.default&&(t.selected=!0),i.appendChild(t)})),n.appendChild(i),void t.appendChild(n)}const c=r("div",{class:"choices"});e.choices.forEach((t=>{const n="checkbox"===e.type&&"sauce"!==e.key,i=r("button",{class:n?"addon-btn":"opt-btn",type:"button","data-price":t.price||0,"data-choice-id":t.id,"aria-pressed":t.default?"true":"false","aria-label":t.label||t.id,text:t.label||t.id});if(!1===t.enabled&&(i.disabled=!0,i.classList.add("disabled")),t.price){const e=r("small",{class:"opt-price",text:" (+"+new Intl.NumberFormat("id-ID").format(t.price)+")"});i.appendChild(e)}i.addEventListener("click",(()=>{if(!1!==t.enabled){if(n){const e="true"===i.getAttribute("aria-pressed");i.setAttribute("aria-pressed",(!e).toString())}else c.querySelectorAll("button").forEach((e=>e.setAttribute("aria-pressed","false"))),i.setAttribute("aria-pressed","true");o()}})),i.addEventListener("keydown",(e=>{"Enter"!==e.key&&" "!==e.key&&"Spacebar"!==e.key||(e.preventDefault(),i.click())})),c.appendChild(i)})),n.appendChild(c),t.appendChild(n)})),o()):t.style.display="none")}function i(){const e=document.getElementById("product-options");if(!e)return 0;let t=0;return e.querySelectorAll("input").forEach((e=>{e.disabled||("checkbox"===e.type&&e.checked&&(t+=Number(e.dataset.price||0)),"radio"===e.type&&e.checked&&(t+=Number(e.dataset.price||0)))})),e.querySelectorAll("select").forEach((e=>{if(e.disabled)return;const r=e.options[e.selectedIndex];r&&!r.disabled&&(t+=Number(r.dataset.price||0))})),e.querySelectorAll("button[data-choice-id]").forEach((e=>{e.disabled||"true"===e.getAttribute("aria-pressed")&&(t+=Number(e.dataset.price||0))})),t}function o(){try{const e=Number(window.productBasePrice||0),r=i(),n=Number(document.getElementById("quantity")?.value||1),o=(e+r)*Math.max(1,n),a=document.getElementById("product-price");a&&(a.textContent=t(e+r));const c=document.getElementById("price-display")||document.getElementById("product-price");c&&(c.textContent=t(o))}catch(e){console.error("updatePriceFromUI error",e)}}function a(){document.querySelectorAll(".option-group").forEach((e=>{const t=Array.from(e.querySelectorAll("button"));if(!t.length)return;const r="addons"===e.dataset.key;t.forEach((e=>{void 0===e.dataset.price&&(e.dataset.price=e.getAttribute("data-price")||0),e.setAttribute("role","button"),e.setAttribute("tabindex","0"),e.addEventListener("click",(()=>{if(r){const t="true"===e.getAttribute("aria-pressed");e.setAttribute("aria-pressed",(!t).toString())}else t.forEach((e=>e.setAttribute("aria-pressed","false"))),e.setAttribute("aria-pressed","true");o()})),e.addEventListener("keydown",(t=>{"Enter"!==t.key&&" "!==t.key&&"Spacebar"!==t.key||(t.preventDefault(),e.click())}))}))}))}try{const r=new URLSearchParams(location.search).get("id");if(r){const i=(await async function(){const e=["dsri.json","products.json","/dsri.json","/products.json"];for(const t of e)try{const e=await fetch(t,{cache:"no-store"});if(!e.ok)continue;const r=await e.json();if(Array.isArray(r))return r}catch(e){}throw new Error("products file not found (tried dsri.json/products.json)")}()).find((e=>e.id===r));if(i){!function(r){const n=e(".product-name"),i=e(".product-subtitle"),o=e("#product-price"),a=e(".product-image"),c=e("#detail-desc"),s=e("#quantity");if(n&&(n.textContent=r.title||"",n.dataset.id=r.id||""),i&&(i.textContent=r.subtitle||""),window.productBasePrice=Number(r.price||0),o&&(o.dataset.base=window.productBasePrice,o.textContent=t(window.productBasePrice),o.setAttribute("aria-live","polite")),a){const e=r.images&&r.images[0]||"",t=r.title||"";a.tagName&&"img"===a.tagName.toLowerCase()?(a.src=e,a.alt=t):a.innerHTML=`<img src="${e}" alt="${t}" />`}c&&(c.innerHTML=r.description||"");const d=document.getElementById("tips-list");d&&(Array.isArray(r.tips)&&r.tips.length>0?(d.innerHTML="",r.tips.forEach((e=>{const t=document.createElement("li");t.textContent=e,d.appendChild(t)}))):d.innerHTML="\n      <li>Serve chilled for best taste.</li>\n      <li>Consume within 4 hours for optimal freshness.</li>\n    "),s&&(!s.value||Number(s.value)<=0)&&(s.value=1)}(i);n(i.options||i.optionGroups||[]),a();const r=document.getElementById("quantity");r&&r.addEventListener("change",o)}else console.error("Product not found for id:",r),a()}else console.error("No product id in URL (use ?id=product-id). Keeping static/default content if present."),a(),document.getElementById("quantity")?.addEventListener("change",o)}catch(e){console.error("Error loading product:",e)}window.renderOptions=n,window.updatePriceFromUI=o,window.computeOptionsDelta=i}();