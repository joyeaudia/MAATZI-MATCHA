// @ts-nocheck
!async function(){"use strict";const e=e=>document.querySelector(e),t=e=>"Rp "+new Intl.NumberFormat("id-ID").format(Number(e)||0);function n(e,t={}){const n=document.createElement(e);return Object.entries(t).forEach((([e,t])=>{"text"===e?n.textContent=t:"html"===e?n.innerHTML=t:"class"===e?n.className=t:n.setAttribute(e,String(t))})),n}function r(e=[]){const t=document.getElementById("product-options");t&&(t.innerHTML="",Array.isArray(e)&&0!==e.length?(t.style.display="",e.forEach((e=>{const r=n("fieldset",{class:"opt-group"}),i=n("legend",{text:e.title||""});r.appendChild(i),e.note&&r.appendChild(n("p",{class:"opt-note",text:e.note}));const a=e.key||"opt_"+Math.random().toString(36).slice(2,7);if("select"===e.type){const i=n("select",{name:a});return i.addEventListener("change",(()=>o())),e.choices.forEach((e=>{const t=n("option",{value:e.id,text:e.label||e.id});t.dataset.price=e.price||0,!1===e.enabled&&(t.disabled=!0),e.default&&(t.selected=!0),i.appendChild(t)})),r.appendChild(i),void t.appendChild(r)}const c=n("div",{class:"choices"});e.choices.forEach((t=>{const r="checkbox"===e.type&&"sauce"!==e.key,i=n("button",{class:r?"addon-btn":"opt-btn",type:"button","data-price":t.price||0,"data-choice-id":t.id,"aria-pressed":t.default?"true":"false","aria-label":t.label||t.id,text:t.label||t.id});if(!1===t.enabled&&(i.disabled=!0,i.classList.add("disabled")),t.price){const e=n("small",{class:"opt-price",text:" (+"+new Intl.NumberFormat("id-ID").format(t.price)+")"});i.appendChild(e)}i.addEventListener("click",(()=>{if(!1!==t.enabled){if(r){const e="true"===i.getAttribute("aria-pressed");i.setAttribute("aria-pressed",(!e).toString())}else c.querySelectorAll("button").forEach((e=>e.setAttribute("aria-pressed","false"))),i.setAttribute("aria-pressed","true");o()}})),i.addEventListener("keydown",(e=>{"Enter"!==e.key&&" "!==e.key&&"Spacebar"!==e.key||(e.preventDefault(),i.click())})),c.appendChild(i)})),r.appendChild(c),t.appendChild(r)})),o()):t.style.display="none")}function i(){const e=document.getElementById("product-options");if(!e)return 0;let t=0;return e.querySelectorAll("input").forEach((e=>{e.disabled||("checkbox"===e.type&&e.checked&&(t+=Number(e.dataset.price||0)),"radio"===e.type&&e.checked&&(t+=Number(e.dataset.price||0)))})),e.querySelectorAll("select").forEach((e=>{if(e.disabled)return;const n=e.options[e.selectedIndex];n&&!n.disabled&&(t+=Number(n.dataset.price||0))})),e.querySelectorAll("button[data-choice-id]").forEach((e=>{e.disabled||"true"===e.getAttribute("aria-pressed")&&(t+=Number(e.dataset.price||0))})),t}function o(){try{const e=Number(window.productBasePrice||0),n=i(),r=Number(document.getElementById("quantity")?.value||1),o=(e+n)*Math.max(1,r),a=document.getElementById("product-price");a&&(a.textContent=t(e+n));const c=document.getElementById("price-display")||document.getElementById("product-price");c&&(c.textContent=t(o))}catch(e){console.error("updatePriceFromUI error",e)}}function a(){document.querySelectorAll(".option-group").forEach((e=>{const t=Array.from(e.querySelectorAll("button"));if(!t.length)return;const n="addons"===e.dataset.key;t.forEach((e=>{void 0===e.dataset.price&&(e.dataset.price=e.getAttribute("data-price")||0),e.setAttribute("role","button"),e.setAttribute("tabindex","0"),e.addEventListener("click",(()=>{if(n){const t="true"===e.getAttribute("aria-pressed");e.setAttribute("aria-pressed",(!t).toString())}else t.forEach((e=>e.setAttribute("aria-pressed","false"))),e.setAttribute("aria-pressed","true");o()})),e.addEventListener("keydown",(t=>{"Enter"!==t.key&&" "!==t.key&&"Spacebar"!==t.key||(t.preventDefault(),e.click())}))}))}))}try{const n=new URLSearchParams(location.search).get("id");if(n){const i=(await async function(){const e=["dsri.json","products.json","/dsri.json","/products.json"];for(const t of e)try{const e=await fetch(t,{cache:"no-store"});if(!e.ok)continue;const n=await e.json();if(Array.isArray(n))return n}catch(e){}throw new Error("products file not found (tried dsri.json/products.json)")}()).find((e=>e.id===n));if(i){!function(n){const r=e(".product-name"),i=e(".product-subtitle"),o=e("#product-price"),a=e(".product-image"),c=e("#detail-desc"),d=e("#quantity");if(r&&(r.textContent=n.title||"",r.dataset.id=n.id||""),i&&(i.textContent=n.subtitle||""),window.productBasePrice=Number(n.price||0),o&&(o.dataset.base=window.productBasePrice,o.textContent=t(window.productBasePrice),o.setAttribute("aria-live","polite")),a){const e=n.images&&n.images[0]||"",t=n.title||"";a.tagName&&"img"===a.tagName.toLowerCase()?(a.src=e,a.alt=t):a.innerHTML=`<img src="${e}" alt="${t}" />`}c&&(c.innerHTML=n.description||"");const s=document.getElementById("tips-list");s&&(Array.isArray(n.tips)&&n.tips.length>0?(s.innerHTML="",n.tips.forEach((e=>{const t=document.createElement("li");t.textContent=e,s.appendChild(t)}))):s.innerHTML="\n      <li>Serve chilled for best taste.</li>\n      <li>Consume within 4 hours for optimal freshness.</li>\n    "),d&&(!d.value||Number(d.value)<=0)&&(d.value=1)}(i);r(i.options||i.optionGroups||[]),a();const n=document.getElementById("quantity");n&&n.addEventListener("change",o)}else console.error("Product not found for id:",n),a()}else console.error("No product id in URL (use ?id=product-id). Keeping static/default content if present."),a(),document.getElementById("quantity")?.addEventListener("change",o)}catch(e){console.error("Error loading product:",e)}window.renderOptions=r,window.updatePriceFromUI=o,window.computeOptionsDelta=i}(),function(){const e=document.getElementById("share-btn"),t=document.getElementById("share-menu"),n=document.getElementById("share-toast"),r=document.getElementById("share-close");if(!e||!t)return;const i=window.location.href;function o(){t.style.display="none",t.setAttribute("aria-hidden","true")}function a(e="Link copied!"){n&&(n.textContent=e,n.hidden=!1,setTimeout((()=>n.hidden=!0),1600))}e.addEventListener("click",(e=>{e.stopPropagation(),t.style.display="block",t.setAttribute("aria-hidden","false")})),r?.addEventListener("click",o),t.addEventListener("click",(e=>{const t=e.target.getAttribute("data-action");t&&("copy"===t&&async function(){try{await navigator.clipboard.writeText(i),a("Link disalin ke clipboard")}catch(e){const t=document.createElement("textarea");t.value=i,document.body.appendChild(t),t.select();try{document.execCommand("copy"),a("Link disalin ke clipboard")}catch(e){alert("Copy failed. Link: "+i)}document.body.removeChild(t)}o()}(),"native"===t&&async function(){if(navigator.share)try{await navigator.share({title:document.title||"Check this product",text:"Lihat produk ini:",url:i})}catch(e){}else{const e="https://api.whatsapp.com/send?text="+encodeURIComponent(i);window.open(e,"_blank")}o()}())})),document.addEventListener("click",(n=>{t.contains(n.target)||n.target===e||o()}))}();