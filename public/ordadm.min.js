// @ts-nocheck
!function(){"use strict";function e(e){try{return JSON.parse(localStorage.getItem(e)||"[]")}catch(e){return[]}}function t(e){try{localStorage.setItem("orders",JSON.stringify(e||[]))}catch(e){console.error("Failed to save orders",e)}}function n(e){return String(e||"").replace(/[&<>"']/g,(e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[e])))}function a(){return e("orders")}function d(e,t){let n;try{n=JSON.parse(localStorage.getItem("notifications_v1")||"[]")}catch(e){n=[]}const a=new Date;let d="",i="",r="";"approved"===t?(d="Payment Confirmed",r="ðŸ’¸",i="Order "+(e.id||"")+" telah dikonfirmasi dan pembayaran sudah diterima admin."):"rejected"===t&&(d="Order Rejected",r="â›”",i="Order "+(e.id||"")+" telah ditolak / dibatalkan oleh admin.");const s={id:"adm-"+t+"-"+(e.id||"")+"-"+a.getTime(),title:d,message:i,emoji:r,time:"Just now",isRead:!1};n.unshift(s);try{localStorage.setItem("notifications_v1",JSON.stringify(n))}catch(e){console.error("Failed to save notifications",e)}}function i(){const r=document.getElementById("admin-content");if(!r)return;r.innerHTML="";let s=a()||[];s=s.filter((e=>"cancelled"!==String(e.status||"").toLowerCase())),s.length?s.forEach((s=>{r.appendChild(function(r){const s=document.createElement("article");s.className="admin-order-card";const o=new Date(r.createdAt||Date.now()).toLocaleString(),c=(r.status||"active").toLowerCase(),l=(r.paymentStatus||"pending").toLowerCase(),m=e("savedAddresses_v1");let u=null;Array.isArray(m)&&m.length&&(u=m.find((e=>e&&e.isDefault))||m[0]);let v="";if(u){const e=n(u.label||""),t=n(u.name||""),a=n(u.phone||"");v=`\n        <div class="admin-address">\n          <div class="admin-address-title">Address</div>\n          <div class="admin-address-main">\n            <div>${`${e||""}${e&&t?" - ":""}${t||""}`}</div>\n            ${a?`<div>${a}</div>`:""}\n            <div>${n(u.address||"").replace(/\n/g,"<br>")}</div>\n          </div>\n        </div>\n      `}const p=r.items&&r.items[0],g=Math.max(0,(r.items||[]).length-1),f=p?n(p.title):"No title",b="paid"===l?"badge-payment paid":"rejected"===l?"badge-payment rejected":"badge-payment";s.innerHTML=`\n      <div class="admin-order-header">\n        <div class="admin-order-id">Order ID: ${n(r.id||"(no id)")}</div>\n        <div class="admin-order-created">${n(o)}</div>\n      </div>\n\n      <div class="admin-status-row">\n        <span class="badge badge-status">Status: ${n(c)}</span>\n        <span class="badge ${b}">Payment: ${n(l)}</span>\n        <span class="badge">Total: ${h=r.total,"Rp "+new Intl.NumberFormat("id-ID").format(Number(h||0))}</span>\n      </div>\n\n      <div class="admin-items">\n        <div>${f}${g>0?" +"+g+" more":""}</div>\n      </div>\n\n      ${v}\n\n          <div class="admin-actions">\n        ${"paid"===l?"":`\n          <button class="btn btn-approve" data-id="${n(r.id)}">ACC (sudah dibayar)</button>\n          <button class="btn btn-reject" data-id="${n(r.id)}">Tolak order</button>\n        `}\n      </div>\n\n    `;var h;const y=s.querySelector(".btn-approve"),S=s.querySelector(".btn-reject");y&&y.addEventListener("click",(function(){const e=this.dataset.id,n=a(),r=n.findIndex((t=>String(t.id)===String(e)));-1!==r&&(n[r].paymentStatus="paid",n[r].status||(n[r].status="active"),d(n[r],"approved"),t(n),i(),alert("Order di-set sebagai SUDAH DIBAYAR."))}));S&&S.addEventListener("click",(function(){const e=this.dataset.id,n=a(),r=n.findIndex((t=>String(t.id)===String(e)));-1!==r&&(n[r].paymentStatus="rejected",n[r].status="cancelled",d(n[r],"rejected"),t(n),i(),alert("Order telah DITOLAK / dibatalkan oleh admin."))}));return s}(s))})):r.innerHTML='<div style="color:#777;font-size:13px;">Belum ada order.</div>'}document.addEventListener("DOMContentLoaded",i)}();