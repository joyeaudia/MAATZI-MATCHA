// @ts-nocheck
import{auth,db}from"./firebase-config";import{signInWithEmailAndPassword}from"https://www.gstatic.com/firebasejs/11.0.0/firebase-auth.js";import{doc,getDoc}from"https://www.gstatic.com/firebasejs/11.0.0/firebase-firestore.js";document.querySelectorAll(".toggle").forEach((e=>{e.addEventListener("click",(()=>{const t=e.previousElementSibling;t&&(t.type="password"===t.type?"text":"password",e.textContent="password"===t.type?"ðŸ‘ï¸":"ðŸ™ˆ")}))}));const signInBtn=document.getElementById("signInBtn");signInBtn&&signInBtn.addEventListener("click",(async()=>{const e=document.getElementById("email"),t=document.getElementById("password"),a=(e?.value||"").trim(),o=t?.value||"";if(a&&o)try{const e=(await signInWithEmailAndPassword(auth,a,o)).user,t=doc(db,"users",e.uid),s=await getDoc(t);let i={};s.exists()&&(i=s.data());const l="byverent@gmail.com",n=i.role||(a.toLowerCase()===l.toLowerCase()?"admin":"user"),r=i.name||e.displayName||"",m=i.phone||"";localStorage.setItem("maziRole",n),localStorage.setItem("maziEmail",a),localStorage.setItem("maziName",r),localStorage.setItem("maziPhone",m);const d=(r||"").split(/\s+/),c=d[0]||"",g=d.slice(1).join(" "),u=localStorage.getItem("profile");let p=null;try{p=JSON.parse(u||"null")}catch{p=null}p=p&&(p.email||"").toLowerCase()===a.toLowerCase()?{...p,firstName:c,lastName:g,phone:m||p.phone}:{firstName:c,lastName:g,email:a,phone:m,memberSince:i.memberSince||(new Date).getFullYear()},localStorage.setItem("profile",JSON.stringify(p)),window.location.href="admin"===n?"frsadm.html":"Home.html"}catch(e){console.error(e);let t="Gagal login. Cek lagi email dan password ya ðŸ™‚";"auth/user-not-found"===e.code?t="Email belum terdaftar. Silakan Sign Up dulu ya ðŸ™‚":"auth/wrong-password"===e.code?t="Password salah. Coba lagi ya ðŸ˜Š":"auth/invalid-email"===e.code&&(t="Format email tidak valid."),alert(t)}else alert("Isi email dan password dulu ya ðŸ™‚")}));