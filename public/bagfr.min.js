// @ts-nocheck
!function(){"use strict";function t(t){return"Rp "+(t=Math.round(Number(t)||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}function e(t){return String(t||"").replace(/[&<>"']/g,(t=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[t])))}function n(){try{return JSON.parse(localStorage.getItem("cart")||"[]")}catch(t){return[]}}function i(t){localStorage.setItem("cart",JSON.stringify(t||[]))}function r(){const i=n(),r=document.getElementById("bag-items")||document.querySelector(".cart-list")||document.querySelector(".bag-items");if(!r)return;if(r.innerHTML="",!i.length)return r.innerHTML='<p class="empty" style="text-align:center;color:#666;padding:18px 0">Keranjang kosong.</p>',void a();let s=0;i.forEach(((n,i)=>{const a=Number(n.unitPrice||n.price||0),c=Number(n.qty||1),d=Number(n.subtotal||a*c||0);s+=d;const o=n.addons&&n.addons.length?n.addons.map((n=>`<div class="addon">${e(n.label||"")} ${n.price?`(+${t(n.price)})`:""}</div>`)).join(""):"",u=`\n        <article class="cart-item" data-idx="${i}" data-price="${a}">\n          <div class="thumb"><img src="${e(n.image||n.images&&n.images[0]||"assets/placeholder.png")}" alt="${e(n.title||"Product")}" onerror="this.onerror=null;this.src='assets/placeholder.png'"></div>\n          <div class="item-body">\n            <div class="item-head">\n              <div>\n                <div class="item-title">${e(n.title||"Untitled")}</div>\n                <div class="item-meta">${o}</div>\n              </div>\n              <button class="remove" title="Hapus item" aria-label="Hapus item" data-idx="${i}">\n                <img src="acs/smph.png" alt="Hapus">\n              </button>\n            </div>\n\n            <div class="item-controls">\n              <div class="qty-control">\n                <button class="qty-btn qty-decr" aria-label="Kurangi">-</button>\n                <span class="qty">${c}</span>\n                <button class="qty-btn qty-incr" aria-label="Tambah">+</button>\n              </div>\n\n              <div class="right-col">\n                <div class="item-sub-value">${t(d)}</div>\n              </div>\n            </div>\n          </div>\n        </article>\n      `,l=document.createElement("div");l.innerHTML=u.trim(),r.appendChild(l.firstElementChild)})),a(s)}function a(e){let i=Number(e||0);if(!e){i=n().reduce(((t,e)=>t+(Number(e.subtotal)||Number(e.unitPrice||e.price||0)*Number(e.qty||1))),0)}const r=document.querySelector(".summary-value")||document.getElementById("bag-total")||document.querySelector(".bag-total");r&&(r.textContent=t(i))}document.addEventListener("click",(function(t){const e=t.target.closest(".cart-item");if(!e)return;const a=Number(e.dataset.idx);let s=n();if(t.target.closest(".qty-incr"))return s[a].qty=Number(s[a].qty||1)+1,s[a].subtotal=Number(s[a].unitPrice||s[a].price||0)*s[a].qty,i(s),void r();if(t.target.closest(".qty-decr"))return s[a].qty=Math.max(1,Number(s[a].qty||1)-1),s[a].subtotal=Number(s[a].unitPrice||s[a].price||0)*s[a].qty,i(s),void r();if(t.target.closest(".remove")){if(!confirm("Hapus item dari keranjang?"))return;return s.splice(a,1),i(s),void r()}})),window.addToBag=function(t){if(!t||!t.id)throw new Error("productObj.id required");const e=n(),a=e.findIndex((e=>e.id===t.id&&JSON.stringify(e.addons||[])===JSON.stringify(t.addons||[])));if(a>=0)e[a].qty=Number(e[a].qty||1)+(Number(t.qty)||1),e[a].subtotal=Number(e[a].unitPrice||e[a].price||0)*e[a].qty;else{const n=Number(t.qty||1),i=Number(t.unitPrice||t.price||0),r={id:t.id,title:t.title||"",unitPrice:i,qty:n,subtotal:Number(t.subtotal||i*n),image:t.image||t.images&&t.images[0]||"assets/placeholder.png",addons:t.addons||[]};e.push(r)}i(e),r()},window.renderCart=r,document.addEventListener("DOMContentLoaded",r)}();