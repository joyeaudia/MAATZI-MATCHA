// @ts-nocheck
document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".buy-pill").forEach((e=>{e.addEventListener("click",(t=>{e.animate([{transform:"scale(1)",opacity:1},{transform:"scale(1.06)",opacity:.95},{transform:"scale(1)",opacity:1}],{duration:220,easing:"cubic-bezier(.2,.8,.2,1)"}),e.setAttribute("aria-pressed","true"),setTimeout((()=>e.removeAttribute("aria-pressed")),600)})),e.addEventListener("keydown",(t=>{" "!==t.key&&"Enter"!==t.key||(t.preventDefault(),e.click())}))}));const e=document.querySelector(".visit .grid");if(!e)return;const t="1"===new URLSearchParams(window.location.search).get("admin"),o="verent_booths_v1";function n(){try{const e=localStorage.getItem(o);return e?JSON.parse(e):null}catch(e){return console.warn("Failed to parse booths data",e),null}}function r(e){try{localStorage.setItem(o,JSON.stringify(e))}catch(e){console.error("Failed to save booths",e)}}function a(){return Array.from(e.querySelectorAll(".chip")).map((e=>({title:(e.querySelector(".chip-title")||{}).textContent||"",small:(e.querySelector(".small")||{}).textContent||""})))}function i(t){const o=Array.from(e.querySelectorAll(".chip"));t.forEach(((t,n)=>{let r=o[n];r||(r=document.createElement("div"),r.className="chip",r.innerHTML='<div class="chip-title"></div><div class="small"></div>',e.appendChild(r));const a=r.querySelector(".chip-title"),i=r.querySelector(".small");a&&(a.textContent=t.title),i&&(i.textContent=t.small)}))}const s=n();if(s&&Array.isArray(s)&&s.length&&i(s),!t)return;const l=document.createElement("div");l.className="admin-booth-bar",l.style.cssText="display:flex;gap:8px;align-items:center;justify-content:flex-end;margin-bottom:8px;",l.innerHTML='\n    <button type="button" class="btn-edit-booths">Edit Booths</button>\n    <button type="button" class="btn-save-booths" style="display:none;">Save</button>\n    <button type="button" class="btn-export-booths">Export</button>\n    <button type="button" class="btn-import-booths">Import</button>\n    <input type="file" accept="application/json" style="display:none;" class="btn-import-file">\n  ',e.parentNode.insertBefore(l,e);const c=l.querySelector(".btn-edit-booths"),d=l.querySelector(".btn-save-booths"),b=l.querySelector(".btn-export-booths"),u=l.querySelector(".btn-import-booths"),p=l.querySelector(".btn-import-file");let h=!1;function y(t=!1){if(h=!1,c.style.display="inline-block",d.style.display="none",e.querySelectorAll(".chip").forEach((e=>{const t=e.querySelector(".chip-title"),o=e.querySelector(".small");t&&(t.removeAttribute("contenteditable"),t.classList.remove("editable")),o&&(o.removeAttribute("contenteditable"),o.classList.remove("editable")),e.style.outline="",e.style.padding=""})),t){r(a()),d.textContent="Saved âœ“",setTimeout((()=>d.textContent="Save"),1200)}}c.addEventListener("click",(()=>function(){h=!0,c.style.display="none",d.style.display="inline-block",e.querySelectorAll(".chip").forEach((e=>{const t=e.querySelector(".chip-title"),o=e.querySelector(".small");t&&(t.setAttribute("contenteditable","true"),t.setAttribute("aria-label","Edit booth title"),t.classList.add("editable")),o&&(o.setAttribute("contenteditable","true"),o.setAttribute("aria-label","Edit booth time"),o.classList.add("editable")),e.style.outline="2px dashed rgba(0,150,80,0.12)",e.style.padding="10px"}));const t=e.querySelector(".chip .chip-title");t&&t.focus()}())),d.addEventListener("click",(()=>y(!0))),b.addEventListener("click",(()=>{const e=a(),t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),o=URL.createObjectURL(t),n=document.createElement("a");n.href=o,n.download="booths.json",document.body.appendChild(n),n.click(),n.remove(),URL.revokeObjectURL(o)})),u.addEventListener("click",(()=>p.click())),p.addEventListener("change",(e=>{const t=e.target.files&&e.target.files[0];if(!t)return;const o=new FileReader;o.onload=e=>{try{const t=JSON.parse(e.target.result);if(!Array.isArray(t))throw new Error("Invalid format: expected array");i(t),r(t),alert("Imported and saved booths.")}catch(e){alert("Failed to import: "+e.message)}},o.readAsText(t)})),document.addEventListener("keydown",(e=>{if(h&&"Escape"===e.key){const e=n();e&&e.length&&i(e),y(!1)}}));const m=document.createElement("style");function f(){try{const e=localStorage.getItem("verent_booths_v1");if(!e)return;const t=JSON.parse(e),o=document.querySelector(".visit .grid");if(!o)return;o.innerHTML="",t.slice(0,4).forEach((e=>{const t=document.createElement("div");t.className="chip",t.innerHTML=`<div class="chip-title">${e.title||""}</div><div class="small">${e.small||""}</div>`,o.appendChild(t)}))}catch(e){console.warn("Failed to reload booths",e)}}function f(){try{const e=localStorage.getItem("verent_booths_v1");if(console.log("UTAMA: raw localStorage for verent_booths_v1 ->",e),!e)return;const t=JSON.parse(e);console.log("UTAMA: parsed booths ->",t)}catch(e){console.error("UTAMA: failed to read booths",e)}}m.innerHTML="\n    .chip .editable:focus {\n      outline: none;\n      box-shadow: 0 0 0 3px rgba(0,150,80,0.12);\n      border-radius: 6px;\n    }\n    .admin-booth-bar .btn-edit-booths,\n    .admin-booth-bar .btn-save-booths,\n    .admin-booth-bar .btn-export-booths,\n    .admin-booth-bar .btn-import-booths {\n      background: #ffffff;\n      border: 1px solid #e6e6e6;\n      padding: 6px 10px;\n      border-radius: 8px;\n      cursor: pointer;\n      font-size: 13px;\n    }\n    .admin-booth-bar .btn-save-booths { background: #e8fff3; border-color: rgba(0,150,80,0.12); }\n  ",document.head.appendChild(m),window.addEventListener("storage",(e=>{"verent_booths_v1"===e.key&&f()})),window.addEventListener("focus",(()=>f())),document.addEventListener("DOMContentLoaded",(()=>f())),window.addEventListener("storage",(e=>{"verent_booths_v1"===e.key&&(console.log("UTAMA: storage event fired",e),f())})),document.addEventListener("DOMContentLoaded",(()=>f()))}));